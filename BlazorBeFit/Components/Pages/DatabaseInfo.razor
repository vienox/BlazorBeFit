@page "/database-info"
@using Microsoft.EntityFrameworkCore
@using BlazorBeFit.Data
@inject ApplicationDbContext DbContext

<PageTitle>Struktura Bazy Danych</PageTitle>

<h3>Informacje o Bazie Danych SQLite</h3>

<div class="card">
    <div class="card-body">
        <h5>Tabele w bazie danych:</h5>
        <ul>
            <li><strong>ExerciseTypes</strong> - Typy ćwiczeń (rekordów: @exerciseTypesCount)</li>
            <li><strong>TrainingSessions</strong> - Sesje treningowe (rekordów: @trainingsCount)</li>
            <li><strong>TrainingEntries</strong> - Wpisy treningowe (rekordów: @entriesCount)</li>
            <li><strong>AspNetUsers</strong> - Użytkownicy (rekordów: @usersCount)</li>
            <li><strong>AspNetRoles</strong> - Role</li>
            <li><strong>AspNetUserRoles</strong> - Przypisania ról</li>
            <li><strong>AspNetUserClaims</strong> - Roszczenia użytkowników</li>
            <li><strong>AspNetRoleClaims</strong> - Roszczenia ról</li>
            <li><strong>AspNetUserLogins</strong> - Zewnętrzne logowania</li>
            <li><strong>AspNetUserTokens</strong> - Tokeny użytkowników</li>
        </ul>

        <h5 class="mt-4">Relacje:</h5>
        <ul>
            <li><strong>TrainingEntries → ExerciseTypes</strong> (CASCADE DELETE)</li>
            <li><strong>TrainingEntries → TrainingSessions</strong> (CASCADE DELETE)</li>
        </ul>

        <h5 class="mt-4">Typy danych:</h5>
        <ul>
            <li><strong>INTEGER</strong> - Klucze główne i obce, liczby całkowite</li>
            <li><strong>TEXT</strong> - Ciągi znaków i daty (DateTime jako ISO 8601)</li>
            <li><strong>REAL</strong> - Liczby zmiennoprzecinkowe (Weight)</li>
        </ul>
    </div>
</div>

@code {
    private int exerciseTypesCount;
    private int trainingsCount;
    private int entriesCount;
    private int usersCount;

    protected override async Task OnInitializedAsync()
    {
        exerciseTypesCount = await DbContext.ExerciseTypes.CountAsync();
        trainingsCount = await DbContext.TrainingSessions.CountAsync();
        entriesCount = await DbContext.TrainingEntries.CountAsync();
        usersCount = await DbContext.Users.CountAsync();
    }
}
